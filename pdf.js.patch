829c829,831
<       console.warn('#' + key + ' is undefined.');
---
>       if (Object.keys(gL10nData).length > 0) {
>         console.warn('#' + key + ' is undefined.');
>       }
10292,10295c10294,10304
< PDFJS.imageResourcesPath = './images/';
<   PDFJS.workerSrc = '../build/pdf.worker.js';
<   PDFJS.cMapUrl = '../web/cmaps/';
<   PDFJS.cMapPacked = true;
---
> var scriptTagContainer = document.body ||
>                          document.getElementsByTagName('head')[0];
> var pdfjsSrc = scriptTagContainer.lastChild.src;
> 
> if (pdfjsSrc) {
>   PDFJS.imageResourcesPath = pdfjsSrc.replace(/pdf\.js$/i, 'images/');
>   PDFJS.workerSrc = pdfjsSrc.replace(/pdf\.js$/i, 'pdf.worker.js');
>   PDFJS.cMapUrl = pdfjsSrc.replace(/pdf\.js$/i, 'cmaps/');
> }
> 
> PDFJS.cMapPacked = true;
11743c11752
<       return this.pdfDocument.numPages;
---
>       return this.pdfDocument ? this.pdfDocument.numPages : 0;
16488c16497
<     return this.pdfDocument.numPages;
---
>     return this.pdfDocument ? this.pdfDocument.numPages : 0;
17024c17033,17035
<     this.pdfDocument.cleanup();
---
>     if (this.pdfDocument) {
>       this.pdfDocument.cleanup();
>     }
17465c17476,17481
< document.addEventListener('DOMContentLoaded', webViewerLoad, true);
---
> // document.addEventListener('DOMContentLoaded', webViewerLoad, true);
> PDFJS.webViewerLoad = function (src) {
>   if (src) DEFAULT_URL = src;
> 
>   webViewerLoad();
> }
17588c17604
<   if (PDFViewerApplication.pdfHistory.isHashChangeUnlocked) {
---
>   if (PDFViewerApplication.pdfHistory && PDFViewerApplication.pdfHistory.isHashChangeUnlocked) {
17740a17757,17759
>   // Ignore mousewheel event if pdfViewer isn't loaded
>   if (!PDFViewerApplication.pdfViewer) return;
>   
